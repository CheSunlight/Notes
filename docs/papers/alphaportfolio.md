# AlphaPortfolio: Direct Construction Through Deep Reinforcement Learning and Interpretable AI

### Author <!-- {docsify-ignore} -->
Lin William Cong et al.

### Publication <!-- {docsify-ignore} -->
Draft in 2021.8

### Introduction
Traditional portfolio management steps:
1. minimize pricing errors or estimate risk premia from historical samples;
2. combine assets to achieve investment objectives.

Drawback of traditional methods:
- there are large estimation errors in step 1;
- the goals in 2 steps are not necessarily aligned.

Financial data tend to be 
- high-dimensional
- noisy
- nonlinear

Recent studies have used ML or NN to tackle the challenges in financial data and the problem of estimation errors. However, they are still in the 2-step framework.

We take a data-driven approach to directly optimize portfolios using DRL. The DL part is an attention-based multi-sequence model which has 2 components: 
- sequence representation extraction model (SREM), such as Transformer Encoder (TE) and Long Short-Term Memory (LSTM), to flexibly and effectively represent and extract information from the time series of high-dimensional input features;
- cross-asset attention network (CAAN) that capture attribute interactions across assets.
 
Our portfolio selection is based on a winner score (model output) generated by the DL part. The strategy is trained by RL based on OOS (out of sample) Sharpe ratio.

Although AI models are effective and applicable, the black-box nature of may hinder their wide use in finance. Thus, we introduce a method called economic distillation to interprete complex AI models. The method is to use gradient-based methods and Lasso to distill the model into a linear model with a small number of input features, while allowing higher-order terms and feature interactions. We find that Tobinâ€™s Q, inventory changes, changes in shares outstanding, etc., play dominant roles.

### Model

#### Sequence Representation Extraction Model (SERM)
The historical states of an asset in a look-back window with length $K$ are denoted as a sequence 
$$
X^{(i)} = \left\{comma  \right\} 
$$

#### Cross-Asset Attention Network (CAAN)